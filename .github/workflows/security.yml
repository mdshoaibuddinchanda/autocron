name: Security Scan

on:
 push:
 branches: [ main, develop ]
 pull_request:
 branches: [ main ]
 schedule:
 - cron: '0 0 * * 0' # Weekly on Sunday

jobs:
 security:
 name: Security Vulnerability Scan
 runs-on: ubuntu-latest
 
 steps:
 - uses: actions/checkout@v4
 
 - name: Set up Python
 uses: actions/setup-python@v5
 with:
 python-version: '3.11'
 
 - name: Install dependencies
 run: |
 python -m pip install --upgrade pip
 pip install safety bandit
 pip install -e .
 
 - name: Run Safety check
 run: safety check --json
 continue-on-error: true
 
 - name: Run Bandit
 run: bandit -r autocron -ll -f json -o bandit-report.json
 continue-on-error: true
 
 - name: Upload Bandit report
 uses: actions/upload-artifact@v4
 with:
 name: bandit-report
 path: bandit-report.json
 if: always()

 dependency-review:
 name: Dependency Review
 runs-on: ubuntu-latest
 if: github.event_name == 'pull_request'
 
 steps:
 - uses: actions/checkout@v4
 
 - name: Dependency Review
 uses: actions/dependency-review-action@v4
